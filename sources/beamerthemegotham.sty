%==============================================================================
%
% Created by Romain NOEL
% Gotham 0.1.a
% 2023-12-12
% Univ-Eiffel corporate design
% Based on LaTeX Metropolis Presentation Template
%
%==============================================================================
\ProvidesPackage{beamerthemegotham}[2023/12/12]

	% Include some custum modifications but quite universal,
	% like set the size appendices or hidden slides...
	\usetheme{BeamerExtra}


% Require Packages
\RequirePackage{etoolbox}
\RequirePackage{xkeyval}


% Theme settings
\providecommand{\PathSOuge}{\PathSO/UGE/}


%% This is file `beamerthemegotham.sty',
%==============================================================================
\pgfkeys{/gotham/.cd,
	.search also={
		/gotham/inner,
		/gotham/outer,
		/gotham/color,
		/gotham/font,
	}
}
\pgfkeys{
	/gotham/titleformat plain/.cd,
		.is choice,
		regular/.code={%
			\let\gotham@plaintitleformat\@empty%
			\setbeamerfont{standout}{shape=\normalfont}%
		},
		smallcaps/.code={%
			\let\gotham@plaintitleformat\@empty%
			\setbeamerfont{standout}{shape=\scshape}%
		},
		allsmallcaps/.code={%
			\let\gotham@plaintitleformat\MakeLowercase%
			\setbeamerfont{standout}{shape=\scshape}%
			\PackageWarning{beamerthemegotham}{%
				Be aware that titleformat plain=allsmallcaps can lead to problems%
			}
		},
		allcaps/.code={%
			\let\gotham@plaintitleformat\MakeUppercase%
			\setbeamerfont{standout}{shape=\normalfont}%
			\PackageWarning{beamerthemegotham}{%
				Be aware that titleformat plain=allcaps can lead to problems%
			}
		},
}
\pgfkeys{
	/gotham/titleformat/.code=\pgfkeysalso{
			font/titleformat title=#1,
			font/titleformat subtitle=#1,
			font/titleformat section=#1,
			font/titleformat frame=#1,
			titleformat plain=#1,
		}
}
\pgfkeys{/gotham/.cd,
	usetitleprogressbar/.code=\pgfkeysalso{outer/progressbar=frametitle},
	noslidenumbers/.code=\pgfkeysalso{outer/numbering=none},
	usetotalslideindicator/.code=\pgfkeysalso{outer/numbering=fraction},
	nosectionslide/.code=\pgfkeysalso{inner/sectionpage=none},
	darkcolors/.code=\pgfkeysalso{color/background=dark},
	blockbg/.code=\pgfkeysalso{color/block=fill, inner/block=fill},
}
\newcommand{\gotham@setdefaults}{
	\pgfkeys{/gotham/.cd,
		titleformat plain=regular,
	}
}
% \usefonttheme{gotham}
%% This is file `beamerfontthemegotham.sty',
%==============================================================================
% \NeedsTeXFormat{LaTeX2e}
% \ProvidesPackage{beamerfontthemegotham}[2017/01/23 gotham font theme]
\RequirePackage{etoolbox}
\RequirePackage{ifxetex}
\RequirePackage{ifluatex}
\RequirePackage{pgfopts}
\ifboolexpr{bool {xetex} or bool {luatex}}{
	\@ifpackageloaded{fontspec}{
		\PassOptionsToPackage{no-math}{fontspec}
	}{
		\RequirePackage[no-math]{fontspec}
	}
	\newcounter{fontsnotfound}
	\newcommand{\checkfont}[1]{%
		\suppressfontnotfounderror=1%
		\font\x = "#1" at 10pt
		\selectfont
		\ifx\x\nullfont%
			\stepcounter{fontsnotfound}%
		\fi%
		\suppressfontnotfounderror=0%
	}

	\newcommand{\iffontsavailable}[3]{%
		\setcounter{fontsnotfound}{0}%
		\expandafter\forcsvlist\expandafter%
		\checkfont\expandafter{#1}%
		\ifnum\value{fontsnotfound}=0%
			#2%
		\else%
			#3%
		\fi%
	}
	\iffontsavailable{Fira Sans Light,%
			Fira Sans Light Italic,%
			Fira Sans,%
			Fira Sans Italic}%
	{%
		\setsansfont[ItalicFont={Fira Sans Light Italic},%
			BoldFont={Fira Sans},%
			BoldItalicFont={Fira Sans Italic}]%
			{Fira Sans Light}%
	}{%
		\iffontsavailable{Fira Sans Light OT,%
				Fira Sans Light Italic OT,%
				Fira Sans OT,%
				Fira Sans Italic OT}%
		{%
			\setsansfont[ItalicFont={Fira Sans Light Italic OT},%
				BoldFont={Fira Sans OT},%
				BoldItalicFont={Fira Sans Italic OT}]%
				{Fira Sans Light OT}%
		}{%
			\PackageWarning{beamerthemegotham}{%
				Could not find Fira Sans fonts%
			}
		}
	}
	\iffontsavailable{Fira Mono, Fira Mono Bold}{%
		\setmonofont[BoldFont={Fira Mono Medium}]{Fira Mono}%
	}{%
		\iffontsavailable{Fira Mono OT, Fira Mono Bold OT}{%
			\setmonofont[BoldFont={Fira Mono Medium OT}]{Fira Mono OT}%
		}{%
			\PackageWarning{beamerthemegotham}{%
				Could not find Fira Mono fonts%
			}
		}
	}
	\AtBeginEnvironment{tabular}{%
		\addfontfeature{Numbers={Monospaced}}%
	}
}{%
	\PackageWarning{beamerthemegotham}{%
		You need to compile with XeLaTeX or LuaLaTeX to use the Fira fonts%
	}
}
\setbeamerfont{title}{size=\Large, series=\bfseries}
\setbeamerfont{author}{size=\small}
\setbeamerfont{date}{size=\small}
\setbeamerfont{section title}{size=\Large, series=\bfseries}
\setbeamerfont{subsection title}{size=\large, series=\bfseries}
\setbeamerfont{subsubsection title}{size=\normalsize, series=\bfseries}
															
\setbeamerfont{block title}{size=\normalsize, series=\bfseries}
\setbeamerfont{block title alerted}{size=\normalsize, series=\bfseries}
\setbeamerfont*{subtitle}{size=\large}
\setbeamerfont{frametitle}{size=\large, series=\bfseries}
\setbeamerfont{frametitleToc}{size=\LARGE, series=\bfseries}
\setbeamerfont{frametitleSection}{size*={60}{1}, series=\bfseries}
\setbeamerfont{caption}{size=\small}
\setbeamerfont{caption name}{series=\bfseries}
\setbeamerfont{description item}{series=\bfseries}
\setbeamerfont{page number in head/foot}{size=\scriptsize}
\setbeamerfont{bibliography entry author}{size=\normalsize, series=\normalfont}
\setbeamerfont{bibliography entry title}{size=\normalsize, series=\bfseries}
\setbeamerfont{bibliography entry location}{size=\normalsize, series=\normalfont}
\setbeamerfont{bibliography entry note}{size=\small, series=\normalfont}
\setbeamerfont{standout}{size=\Large, series=\bfseries}
\pgfkeys{
	/gotham/font/titleformat title/.cd,
		.is choice,
		regular/.code={%
			\let\gotham@titleformat\@empty%
			\setbeamerfont{title}{shape=\normalfont}%
		},
		smallcaps/.code={%
			\let\gotham@titleformat\@empty%
			\setbeamerfont{title}{shape=\scshape}%
		},
		allsmallcaps/.code={%
			\let\gotham@titleformat\lowercase%
			\setbeamerfont{title}{shape=\scshape}%
			\PackageWarning{beamerthemegotham}{%
				Be aware that titleformat title=allsmallcaps can lead to problems%
			}
		},
		allcaps/.code={%
			\let\gotham@titleformat\uppercase%
			\setbeamerfont{title}{shape=\normalfont}
			\PackageWarning{beamerthemegotham}{%
				Be aware that titleformat title=allcaps can lead to problems%
			}
		},
}
\pgfkeys{
	/gotham/font/titleformat subtitle/.cd,
		.is choice,
		regular/.code={%
			\let\gotham@subtitleformat\@empty%
			\setbeamerfont{subtitle}{shape=\normalfont}%
		},
		smallcaps/.code={%
			\let\gotham@subtitleformat\@empty%
			\setbeamerfont{subtitle}{shape=\scshape}%
		},
		allsmallcaps/.code={%
			\let\gotham@subtitleformat\lowercase%
			\setbeamerfont{subtitle}{shape=\scshape}%
			\PackageWarning{beamerthemegotham}{%
				Be aware that titleformat subtitle=allsmallcaps can lead to problems%
			}
		},
		allcaps/.code={%
			\let\gotham@subtitleformat\uppercase%
			\setbeamerfont{subtitle}{shape=\normalfont}%
			\PackageWarning{beamerthemegotham}{%
				Be aware that titleformat subtitle=allcaps can lead to problems%
			}
		},
}
\pgfkeys{
	/gotham/font/titleformat section/.cd,
		.is choice,
		regular/.code={%
			\let\gotham@sectiontitleformat\@empty%
			\setbeamerfont{section title}{shape=\normalfont}%
		},
		smallcaps/.code={%
			\let\gotham@sectiontitleformat\@empty%
			\setbeamerfont{section title}{shape=\scshape}%
		},
		allsmallcaps/.code={%
			\let\gotham@sectiontitleformat\MakeLowercase%
			\setbeamerfont{section title}{shape=\scshape}%
			\PackageWarning{beamerthemegotham}{%
				Be aware that titleformat section=allsmallcaps can lead to problems%
			}
		},
		allcaps/.code={%
			\let\gotham@sectiontitleformat\MakeUppercase%
			\setbeamerfont{section title}{shape=\normalfont}%
			\PackageWarning{beamerthemegotham}{%
				Be aware that titleformat section=allcaps can lead to problems%
			}
		},
}
\pgfkeys{
	/gotham/font/titleformat frame/.cd,
		.is choice,
		regular/.code={%
			\let\gotham@frametitleformat\@empty%
			\setbeamerfont{frametitle}{shape=\normalfont}%
		},
		smallcaps/.code={%
			\let\gotham@frametitleformat\@empty%
			\setbeamerfont{frametitle}{shape=\scshape}%
		},
		allsmallcaps/.code={%
			\let\gotham@frametitleformat\MakeLowercase%
			\setbeamerfont{frametitle}{shape=\scshape}%
			\PackageWarning{beamerthemegotham}{%
				Be aware that titleformat frame=allsmallcaps can lead to problems%
			}
		},
		allcaps/.code={%
			\let\gotham@frametitleformat\MakeUppercase%
			\setbeamerfont{frametitle}{shape=\normalfont}
			\PackageWarning{beamerthemegotham}{%
				Be aware that titleformat frame=allcaps can lead to problems%
			}
		},
}
\pgfkeys{
	/gotham/font/.cd,
	titleformattitle/.code=\pgfkeysalso{titleformat title=#1},
	titleformatsubtitle/.code=\pgfkeysalso{titleformat subtitle=#1},
	titleformatsection/.code=\pgfkeysalso{titleformat section=#1},
	titleformatframe/.code=\pgfkeysalso{titleformat frame=#1},
}
\newcommand{\gotham@font@setdefaults}{
	\pgfkeys{/gotham/font/.cd,
		titleformat title=regular,
		titleformat subtitle=regular,
		titleformat section=regular,
		titleformat frame=regular,
	}
}
\def\gotham@titleformat#1{#1}
\def\gotham@subtitleformat#1{#1}
\def\gotham@sectiontitleformat#1{#1}
\def\gotham@frametitleformat#1{#1}
\patchcmd{\beamer@title}%
	{\def\inserttitle{#2}}%
	{\def\inserttitle{\gotham@titleformat{#2}}}%
	{}%
	{\PackageError{beamerfontthemegotham}{Patching title failed}\@ehc}
\patchcmd{\beamer@subtitle}%
	{\def\insertsubtitle{#2}}%
	{\def\insertsubtitle{\gotham@subtitleformat{#2}}}%
	{}%
	{\PackageError{beamerfontthemegotham}{Patching subtitle failed}\@ehc}
\patchcmd{\sectionentry}
	{\def\insertsectionhead{#2}}
	{\def\insertsectionhead{\gotham@sectiontitleformat{#2}}}
	{}
	{\PackageError{beamerfontthemegotham}{Patching section title failed}\@ehc}
\@tempswafalse
\patchcmd{\beamer@section}
	{\def\insertsectionhead{\hyperlink{Navigation\the\c@page}{#1}}}
	{\def\insertsectionhead{\hyperlink{Navigation\the\c@page}{%
		\gotham@sectiontitleformat{#1}}}}
	{\@tempswatrue}
	{}
\patchcmd{\beamer@section}
	{\protected@edef\insertsectionhead{\noexpand\hyperlink{Navigation\the\c@page}{#1}}}
	{\protected@edef\insertsectionhead{\noexpand\hyperlink{Navigation\the\c@page}{%
		\noexpand\gotham@sectiontitleformat{#1}}}}
	{\@tempswatrue}
	{}
\if@tempswa\else
	\PackageError{beamerfontthemegotham}{Patching section title failed}\@ehc
\fi
\@tempswafalse
\patchcmd{\beamer@subsection}
	{\def\insertsubsectionhead{\hyperlink{Navigation\the\c@page}{#1}}}
	{\def\insertsubsectionhead{\hyperlink{Navigation\the\c@page}{%
		\gotham@sectiontitleformat{#1}}}}
	{\@tempswatrue}
	{}
\patchcmd{\beamer@subsection}
	{\protected@edef\insertsubsectionhead{\noexpand\hyperlink{Navigation\the\c@page}{#1}}}
	{\protected@edef\insertsubsectionhead{\noexpand\hyperlink{Navigation\the\c@page}{%
		\noexpand\gotham@sectiontitleformat{#1}}}}
	{\@tempswatrue}
	{}
\if@tempswa\else
	\PackageError{beamerfontthemegotham}{Patching subsection title failed}\@ehc
\fi
\@tempswafalse
% \patchcmd{\beamer@subsubsection}
% 	{\def\insertsubsubsectionhead{\hyperlink{Navigation\the\c@page}{#1}}}
% 	{\def\insertsubsubsectionhead{\hyperlink{Navigation\the\c@page}{%
% 		\gotham@sectiontitleformat{#1}}}}
% 	{\@tempswatrue}
% 	{}
% \patchcmd{\beamer@subsubsection}
% 	{\protected@edef\insertsubsubsectionhead{\noexpand\hyperlink{Navigation\the\c@page}{#1}}}
% 	{\protected@edef\insertsubsubsectionhead{\noexpand\hyperlink{Navigation\the\c@page}{%
% 		\noexpand\gotham@sectiontitleformat{#1}}}}
% 	{\@tempswatrue}
% 	{}
% \if@tempswa\else
% 	\PackageError{beamerfontthemegotham}{Patching subsubsection title failed}\@ehc
% \fi
\patchcmd{\beamer@@frametitle}
	{{%
			\gdef\insertframetitle{{#2\ifnum\beamer@autobreakcount>0\relax{}\space%
			\usebeamertemplate*{frametitle continuation}\fi}}%
		\gdef\beamer@frametitle{#2}%
		\gdef\beamer@shortframetitle{#1}%
		}}
	{{%
			\gdef\insertframetitle{{\gotham@frametitleformat{#2}\ifnum%
			\beamer@autobreakcount>0\relax{}\space%
			\usebeamertemplate*{frametitle continuation}\fi}}%
		\gdef\beamer@frametitle{#2}%
		\gdef\beamer@shortframetitle{#1}%
		}}
	{}
	{\PackageError{beamerfontthemegotham}{Patching frame title failed}\@ehc}
\gotham@font@setdefaults
\ProcessPgfPackageOptions{/gotham/font}
%\endinput
%%
%% End of file `beamerfontthemegotham.sty'.

% \usecolortheme{gotham}
%% This is file `beamercolorthemegotham.sty',
%==============================================================================
% \NeedsTeXFormat{LaTeX2e}
% \ProvidesPackage{beamercolorthemegotham}[2017/01/23 gotham color theme]
\RequirePackage{pgfopts}
\pgfkeys{
	/gotham/color/block/.cd,
		.is choice,
		transparent/.code=\gotham@block@transparent,
		fill/.code=\gotham@block@fill,
}
\pgfkeys{
	/gotham/color/background/.cd,
		.is choice,
		dark/.code=\gotham@colors@dark,
		light/.code=\gotham@colors@light,
		transparent/.code=\gotham@colors@transparent,
}
\newcommand{\gotham@color@setdefaults}{
	\pgfkeys{/gotham/color/.cd,
		background=transparent,
		block=fill,
	}
}
\definecolor{mDarkBrown}{HTML}{604c38}
\definecolor{mDarkTeal}{HTML}{23373b}
\definecolor{mLightBrown}{HTML}{EB811B}
\definecolor{mLightGreen}{HTML}{14B03D}

\definecolor{pale}{RGB}{255, 255, 240}
% \definecolor{pale}{RGB}{255, 255, 0}
\definecolor{dark}{RGB}{25,25,25}

\providebool{reversedColor}
\boolfalse{reversedColor}

\newcommand{\gotham@colors@dark}{
	\setbeamercolor{normal text}{%
		% fg=,
		fg=pale,
		bg=dark,
	}%
	\usebeamercolor[fg]{normal text}%
	\booltrue{reversedColor}%
	% dark
	\setbeamercolor{palette primary}{%
		use=normal text,
		fg=normal text.bg,
		bg=normal text.fg
	}
}
\newcommand{\gotham@colors@light}{
	\setbeamercolor{normal text}{%
		fg=dark,
		% bg=,
		bg=pale
	}%
	\usebeamercolor[fg]{normal text}%
	\boolfalse{reversedColor}%
	% light 
	\setbeamercolor{palette primary}{%
		use=normal text,
		fg=pale, %normal text.bg,
		bg=normal text.fg
	}
}
\newcommand{\gotham@colors@transparent}{
	\setbeamercolor{normal text}{%
		fg=dark,
		bg=,
		% bg=pale
	}%
	\usebeamercolor[fg]{normal text}%
	\boolfalse{reversedColor}%
	% light 
	\setbeamercolor{palette primary}{%
		use=normal text,
		fg=pale, %normal text.bg,
		bg=normal text.fg
	}
}
\setbeamercolor{alerted text}{%
	fg=mLightBrown
}
\setbeamercolor{example text}{%
	fg=mLightGreen
}
\setbeamercolor{titlelike}{use=normal text, parent=normal text}
\setbeamercolor{author}{use=normal text, parent=normal text}
\setbeamercolor{date}{use=normal text, parent=normal text}
\setbeamercolor{institute}{use=normal text, parent=normal text}
\setbeamercolor{structure}{use=normal text, fg=normal text.fg}
% \ifbeamercolorempty[bg]{normal text}{
% 	% light
% 	\setbeamercolor{palette primary}{%
% 		use=normal text,
% 		fg=green,
% 		bg=normal text.fg
% 	}
% }{%
% 	% dark
% 	\setbeamercolor{palette primary}{%
% 		use=normal text,
% 		fg=normal text.bg,
% 		bg=normal text.fg
% 	}
% }%

\setbeamercolor{palette reversed primary}{%
	use=normal text,
	parent=palette primary,
	fg=normal text.fg,
	bg=normal text.bg
}
\setbeamercolor{frametitle}{%
	use=palette primary,
	parent=palette primary
}
\colorlet{ColorProgBar}{orange!65} %mLightBrown , structure

\setbeamercolor{progress bar}{%
	use=alerted text,
	fg=ColorProgBar, %alerted text.fg,
	bg=alerted text.fg!50!black!30
}
\setbeamercolor{title separator}{
	use=progress bar,
	parent=progress bar
}
\setbeamercolor{progress bar in head/foot}{%
	use=progress bar,
	parent=progress bar
}
\setbeamercolor{progress bar in section page}{
	use=progress bar,
	parent=progress bar
}
\setbeamercolor{progress bar in subsection page}{
	use=progress bar,
	parent=progress bar
}
\setbeamercolor{progress bar in subsubsection page}{
	use=progress bar,
	parent=progress bar
}
\newcommand{\gotham@block@transparent}{
	\setbeamercolor{block title}{%
		use=normal text,
		fg=normal text.fg,
		bg=
	}
	\setbeamercolor{block body}{
		bg=
	}
}
\newcommand{\gotham@block@fill}{
	\setbeamercolor{block title}{%
		use=normal text,
		fg=normal text.fg,
		bg=normal text.bg!80!fg
	}
	\setbeamercolor{block body}{
		use={block title, normal text},
		bg=block title.bg!50!normal text.bg
	}
}
\setbeamercolor{block title alerted}{%
		use={block title, alerted text},
		bg=block title.bg,
		fg=alerted text.fg
}
\setbeamercolor{block title example}{%
		use={block title, example text},
		bg=block title.bg,
		fg=example text.fg
}
\setbeamercolor{block body alerted}{use=block body, parent=block body}
\setbeamercolor{block body example}{use=block body, parent=block body}
\setbeamercolor{footnote}{fg=normal text.fg!90}
\setbeamercolor{footnote mark}{fg=.}
\setbeamercolor{frametitleSection}{use=primary palette, bg=, fg=primary palette.bg} %'bg= ' for transparent, % bg=primary palette.fg
\setbeamercolor{background standout}{use=primary palette, bg=primary palette.fg, fg=primary palette.bg}
\setbeamercolor{background standin}{use=normal text, bg=normal text.bg, fg=normal text.fg}
\colorlet{colorFiligrane}{gray}

\setbeamercolor{section in toc}{use=normal text, parent=normal text,}%
\setbeamercolor{subsection in toc}{use=normal text, parent=normal text,}%
\setbeamercolor{subsubsection in toc}{use=normal text, parent=normal text,}%

\gotham@color@setdefaults
\ProcessPgfPackageOptions{/gotham/color}
\mode<all>
%\endinput
%%
%% End of file `beamercolorthemegotham.sty'.

% \useinnertheme{gotham}
%% This is file `beamerinnerthemegotham.sty',
%==============================================================================
% \NeedsTeXFormat{LaTeX2e}
% \ProvidesPackage{beamerinnerthemegotham}[2017/01/23 gotham inner theme]
\RequirePackage{etoolbox}
\RequirePackage{keyval}
\RequirePackage{calc}
\RequirePackage{pgfopts}
\RequirePackage{tikz}
\pgfkeys{
	/gotham/inner/sectionpage/.cd,
		.is choice,
		none/.code=\gotham@disablesectionpage,
		simple/.code={\gotham@enablesectionpage
			\setbeamertemplate{progress bar in section page}[empty] },
		progressbar/.code={\gotham@enablesectionpage
			\setbeamertemplate{progress bar in section page}[display] },
}
\pgfkeys{
	/gotham/inner/subsectionpage/.cd,
		.is choice,
		none/.code=\gotham@disablesubsectionpage,
		simple/.code={\gotham@enablesubsectionpage
			\setbeamertemplate{progress bar in subsection page}[empty]},
		progressbar/.code={\gotham@enablesubsectionpage
			\setbeamertemplate{progress bar in subsection page}[display]},
}
\pgfkeys{
	/gotham/inner/subsubsectionpage/.cd,
		.is choice,
		none/.code=\gotham@disablesubsubsectionpage,
		simple/.code={\gotham@enablesubsubsectionpage
			\setbeamertemplate{progress bar in subsubsection page}[empty]},
		progressbar/.code={\gotham@enablesubsubsectionpage
			\setbeamertemplate{progress bar in subsubsection page}[display]},
}
\newcommand{\gotham@inner@setdefaults}{
	\pgfkeys{/gotham/inner/.cd,
		sectionpage=progressbar,
		subsectionpage=progressbar,
		subsubsectionpage=progressbar
	}
}
% The command to insert the institute logo on title page
\newcommand{\gothamtitlepagelogo}{logo institute title page}
% The command to insert the background title page
\newcommand{\gothamtitlepagebg}{background title page}
\defbeamertemplate*{title page}{gotham}{
	\begin{picture}(0,0)
		% The background picture
		\put(-28,-128){\gothamtitlepagebg}
		
		% The text: title, author, institute, etc.
		\put(-4,-125){\noindent%
			\ifbool{reversedColor}{% Dark true 
				% \fcolorbox{pale}{pale}%{ % reversed
				\fcolorbox{dark}{dark}%{ % normal
			}{% Light
				% \fcolorbox{dark}{dark}%{ %reversed
				\fcolorbox{normal text.bg}{normal text.bg}%{ % normal
			}% end if
			{% begin third argument fcolorobx
				%\fcolorbox{normal text.fg}{normal text.fg}{%
				\begin{minipage}[b][\paperheight]{\textwidth}%\paperwidth}%\textwidth}
					% \ifbool{reversedColor}{ % Dark true 
					% 	\setbeamercolor{normal text}{fg=dark, }%
					% }{% Light
					% 	\setbeamercolor{normal text}{fg=pale, }%
					% }%
					\centering
					\vfill%
					\ifx\inserttitle\@empty\else\quad\usebeamertemplate*{title}\fi
					\ifx\insertsubtitle\@empty\else\quad\usebeamertemplate*{subtitle}\fi
					% \hbox{\hspace{2pt}
					\usebeamertemplate*{title separator}
					% \hspace{1pt}}
					\ifx\beamer@shortauthor\@empty\else\usebeamertemplate*{author}\fi
					\ifx\insertdate\@empty\else\usebeamertemplate*{date}\fi
					\ifx\insertinstitute\@empty\else{\parbox{0.9\textwidth}{\raggedright\usebeamertemplate*{institute}} }\fi
					\vfill
					\vbox{}
				\end{minipage}%
			}%
		}
		
		% the institute logo on title page
		\put(234,-120){%
			\gothamtitlepagelogo
		}
		
		% the extra logos on title page (\inserttitlegraphic)
		\put(-27,-123){%
			\noindent\vbox{%
				\begin{minipage}[b][0.96\paperheight]{0.899\textwidth}%
				\ifx\inserttitlegraphic\@empty\else\usebeamertemplate*{title graphic}\fi%
				\end{minipage}%
			}%
		}
	\end{picture}
}
\def\maketitle{%
	\ifbeamer@inframe
		\titlepage
	\else
		\frame[plain, noframenumbering]{\titlepage}
	\fi
}
\def\titlepage{%
	\usebeamertemplate{title page}
}
\defbeamertemplate*{title graphic}{gotham}{
	\vbox{% \vbox to 0pt {% %%%%% MODIFIED !
		% \vspace*{2em} %%%%% COMMENT ADDED !
		\inserttitlegraphic%
	}%
	\nointerlineskip%
}
\defbeamertemplate*{title}{gotham}{
	%\raggedright% %%%%% COMMENT ADDED !
	\linespread{1.0}%
	\inserttitle%
	\par%
	\vspace*{0.5em}
}
\defbeamertemplate*{subtitle}{gotham}{
	%\raggedright% %%%%% COMMENT ADDED !
	\insertsubtitle%
	\par%
	\vspace*{0.5em}
}
\newlength{\gotham@titleseparator@linewidth}
\setlength{\gotham@titleseparator@linewidth}{\textwidth}
\newlength{\gotham@titleseparator@lineheight}
\setlength{\gotham@titleseparator@lineheight}{2pt}%{0.4pt}
\defbeamertemplate*{title separator}{gotham}{
	\begin{tikzpicture}
		\fill[fg] (0,0) rectangle (\gotham@titleseparator@linewidth, \gotham@titleseparator@lineheight);
	\end{tikzpicture}%
	\par%
}
\defbeamertemplate*{author}{gotham}{
	\vspace*{2em}
	\insertauthor%
	\par%
	\vspace*{0.25em}
}
\defbeamertemplate*{date}{gotham}{
	\insertdate%
	\par%
}
\defbeamertemplate*{institute}{gotham}{
	\vspace*{3mm}
	\insertinstitute%
	\par%
}
% \pgfdeclareimage[height=<dim>, width=<dim>, page=<page number>, interpolate=<true or false>, mask=<mask name> ]{<KeyName>}{<file name>}
% command to add standout background
\newcommand{\gothamStandoutBG}{%
	background standout
}

% command to add section (standin) background
\newcommand{\gothamStandinBG}{%
	background standin
}

% repeated from BeamerExtra
\providebool{sectionContent}
\booltrue{sectionContent}
\providecommand{\secContentName}{Section content}
\providebool{subsectionContent}
\booltrue{subsectionContent}
\providecommand{\subsecContentName}{Subsection content}

\defbeamertemplate{background canvas}{empty}{}%
\defbeamertemplate{background}{empty}{}%
\defbeamertemplate{background}{gotham watermark}{%
	% Command to add watermark in background
	\begin{tikzpicture}[overlay,remember picture]
		\node[color=red, opacity=0.3, scale=5, rotate=45] at ([shift={(0,0)}]current page.center) {DRAFT};
	\end{tikzpicture}%
}

% bool to trigger the add of watermark in background
\providebool{gotham@noBGC}
\boolfalse{gotham@noBGC}
% Capture new options/keys for frames 
\define@key{beamerframe}{noBGC}[true]{%
	\booltrue{gotham@noBGC}
	\begingroup
		\setbeamertemplate{background canvas}[empty]
}
\apptocmd{\beamer@reseteecodes}{%
	\ifbool{gotham@noBGC}{
		\endgroup
		\boolfalse{gotham@noBGC}
	}{}
}{}{}

% bool to trigger the add of watermark in background
\providebool{gotham@watermark}
\boolfalse{gotham@watermark}
% bool to trigger the add of watermark in background
\providebool{gotham@nowatermark}
\boolfalse{gotham@nowatermark}
% bool to display the watermark by default (or not)
\providebool{defaultWaterMark}
\boolfalse{defaultWaterMark}

% At every new frame, reset the options to default (unless some options/keys are given)
\BeforeBeginEnvironment{frame}{%
	\ifbool{defaultWaterMark}{% true
		\setbeamertemplate{background}[gotham watermark]
	}{% false
		\setbeamertemplate{background}[empty]
	}%
}
% Capture new options/keys for frames 
\define@key{beamerframe}{watermark}[true]{%
	\booltrue{gotham@watermark}
	\begingroup
		\setbeamertemplate{background}[gotham watermark]
}
	\apptocmd{\beamer@reseteecodes}{%
		\ifbool{gotham@watermark}{
			\endgroup
			\boolfalse{gotham@watermark}
		}{}
	}{}{}
\define@key{beamerframe}{nowatermark}[true]{%
	\booltrue{gotham@nowatermark}
	\begingroup
		\setbeamertemplate{background}[empty]
}
	\apptocmd{\beamer@reseteecodes}{%
		\ifbool{gotham@nowatermark}{
			\endgroup
			\boolfalse{gotham@nowatermark}
		}{}
	}{}{}

\defbeamertemplate*{section title}{gotham}{
	\usebeamercolor[fg]{section title}
	\usebeamerfont{section title}
	\insertsectionnumber. %
	\insertsectionhead
}
\defbeamertemplate*{subsection title}{gotham}{
	\usebeamercolor[fg]{subsection title}
	\usebeamerfont{subsection title}
	\insertsectionnumber.\insertsubsectionnumber. %
	\insertsubsectionhead
}
\defbeamertemplate*{subsubsection title}{gotham}{
	\usebeamercolor[fg]{subsubsection title}
	\usebeamerfont{subsubsection title}
	\insertsectionnumber.\insertsubsectionnumber.\insertsubsubsectionnumber. %
	\insertsubsubsectionhead
}
\newlength{\sectionhoffset}
\setlength{\sectionhoffset}{0pt}

\defbeamertemplate*{section page}{progressbar/simple}{
	%\frametitle{toto section}
	\centering
	\hspace*{\sectionhoffset}
	\begin{minipage}{22em}
		\raggedright
		\usebeamertemplate*{section title}\\[-1ex]
		\usebeamertemplate*{progress bar in section page}
		\par
	\end{minipage}
	\par
	\vspace{\baselineskip}
}
\defbeamertemplate*{subsection page}{progressbar/simple}{
	%\frametitle{toto section}
	\centering
	\hspace*{\sectionhoffset}
	\begin{minipage}{22em}
		\raggedright
		\usebeamertemplate*{section title}\\[-1ex]
		\usebeamertemplate*{progress bar in subsection page}
		\par
		\usebeamertemplate*{subsection title}
	\end{minipage}
	\par
	\vspace{\baselineskip}
}
\newcommand{\gotham@disablesectionpage}{
	\AtBeginSection{
		% intentionally empty
	}
}
\newcommand{\gotham@enablesectionpage}{
	%Section
	\AtBeginSection{
		\ifbeamer@inframe
			\sectionpage
		\else
			\frame[c, noframenumbering, section]{\sectionpage}% , sec
		\fi
		
		\ifbool{sectionContent}{% true
			\begin{frame}[noframenumbering, tocsec]% , tocsec
			\frametitle{\secContentName}
				{\tableofcontents[currentsection, currentsubsection, 
					hideothersubsections, 
					sectionstyle=show/shaded,
					]
				}
			\end{frame}
		}{% else 
		} % end ifbool
	}% end atbeginsection
}
\newcommand{\gotham@disablesubsectionpage}{
  \AtBeginSubsection{
    % intentionally empty
  }
}
\newcommand{\gotham@enablesubsectionpage}{
	\AtBeginSubsection{
		\ifbeamer@inframe
			\subsectionpage
		\else
			\frame[c, noframenumbering, subsec]{\subsectionpage}
		\fi

		\ifbool{subsectionContent}{% true
			\begin{frame}[noframenumbering, tocsubsec]% ,
			\frametitle{\subsecContentName}
				{\tableofcontents[currentsection, currentsubsection, %currentsubsubsection, 
					hideothersubsections, 
					sectionstyle=show/shaded,
					subsectionstyle=show/shaded/hide,
					subsubsectionstyle=show/show/hide,
					]
				}
			\end{frame}
		}{% else 
		} % end ifbool
	}% end atbeginsubsection
}
\def\subsubsectionname{\translate{Subsubsection}}
\def\insertsubsubsectionnumber{\arabic{subsubsection}}
\defbeamertemplate*{subsubsection page}{progressbar/simple}{
	% \frametitle{toto section}
	\centering
	\hspace*{\sectionhoffset}
	\begin{minipage}{22em}
		\raggedright
		\usebeamertemplate*{section title}\\[-1ex]
		\usebeamertemplate*{progress bar in subsubsection page}
		\par
		\usebeamertemplate*{subsection title}
		\par
		\usebeamertemplate*{subsubsection title}
	\end{minipage}
	\par
	\vspace{\baselineskip}
}
\def\subsubsectionpage{\usebeamertemplate*{subsubsection page}}

\newcommand{\gotham@disablesubsubsectionpage}{
  \AtBeginSubsubsection{
    % intentionally empty
  }
}
\newcommand{\gotham@enablesubsubsectionpage}{
	\AtBeginSubsubsection{
		\ifbeamer@inframe
			\subsubsectionpage
		\else
			\frame[c, noframenumbering, subsubsec]{\subsubsectionpage}
		\fi
	}
}
\newlength{\gotham@progressonsectionpage}
\newlength{\gotham@progressonsectionpage@linewidth}
\setlength{\gotham@progressonsectionpage@linewidth}{3pt}%{0.4pt}
\defbeamertemplate{progress bar in section page}{empty}{%
	\vspace{\gotham@progressonsectionpage@linewidth+1ex}
}
\defbeamertemplate{progress bar in section page}{display}{
	\setlength{\gotham@progressonsectionpage}{%
		\textwidth * \ratio{\insertframenumber pt}{\inserttotalframenumber pt}%
	}%
	\begin{tikzpicture}
		\fill[bg] (0,0) rectangle (\textwidth, \gotham@progressonsectionpage@linewidth);
		\fill[fg] (0,0) rectangle (\gotham@progressonsectionpage, \gotham@progressonsectionpage@linewidth);
	\end{tikzpicture}%
}
\defbeamertemplate{progress bar in subsection page}{empty}{%
	\setbeamertemplate{progress bar in section page}[empty]%
	\usebeamertemplate{progress bar in section page}%
}
\defbeamertemplate{progress bar in subsection page}{display}{
	\setbeamertemplate{progress bar in section page}[display]%
	\usebeamertemplate{progress bar in section page}%
}
\defbeamertemplate{progress bar in subsubsection page}{empty}{%
	\setbeamertemplate{progress bar in section page}[empty]%
	\usebeamertemplate{progress bar in section page}%
}
\defbeamertemplate{progress bar in subsubsection page}{display}{
	\setbeamertemplate{progress bar in section page}[display]%
	\usebeamertemplate{progress bar in section page}%
}
\def\inserttotalframenumber{100}

\defbeamertemplate{background canvas}{section gotham}[1][]
{%
	\ifbeamercolorempty[bg]{normal text}{}{\color{bg}\vrule width\paperwidth height\paperheight}%
	% \begin{tikzpicture}[overlay,remember picture]
	% 	\node[color=red, opacity=0.3, scale=5, rotate=45] at ([shift={(0,0)}]current page.center) {SECTION};
	% \end{tikzpicture}%
}

\defbeamertemplate{background canvas}{toc subsection gotham}[1][]
{%
	\ifbeamercolorempty[bg]{normal text}{}{\color{bg}\vrule width\paperwidth height\paperheight}%
	% \begin{tikzpicture}[overlay,remember picture]
	% 	\node[color=red, opacity=0.3, scale=5, rotate=45] at ([shift={(0,0)}]current page.center) {TOC SUBSEC};
	% \end{tikzpicture}%
}

\defbeamertemplate{background canvas}{toc section gotham}[1][]
{%
	\ifbeamercolorempty[bg]{normal text}{}{\color{bg}\vrule width\paperwidth height\paperheight}%
	% \begin{tikzpicture}[overlay,remember picture]
	% 	\node[color=red, opacity=0.3, scale=5, rotate=45] at ([shift={(0,0)}]current page.center) {TOC SEC};
	% \end{tikzpicture}%
}

\defbeamertemplate{background canvas}{subsection gotham}[1][]
{%
	\ifbeamercolorempty[bg]{normal text}{}{\color{bg}\vrule width\paperwidth height\paperheight}%
	% \begin{tikzpicture}[overlay,remember picture]
	% 	\node[color=red, opacity=0.3, scale=5, rotate=45] at ([shift={(0,0)}]current page.center) {SUBSECTION};
	% \end{tikzpicture}%
}
\defbeamertemplate{background canvas}{subsubsection gotham}[1][]
{%
	\ifbeamercolorempty[bg]{normal text}{}{\color{bg}\vrule width\paperwidth height\paperheight}%
	% \begin{tikzpicture}[overlay,remember picture]
	% 	\node[color=red, opacity=0.3, scale=5, rotate=45] at ([shift={(0,0)}]current page.center) {subSUBSECT};
	% \end{tikzpicture}%
}

\defbeamertemplate{frametitle}{section gotham}[1][]
{%
	\nointerlineskip%
	\hspace*{-\leftskip-\gotham@frametitle@leftpadding+1.45ex}%
	% \hspace*{-1.155cm}%
	\begin{beamercolorbox}[%
			wd=0.3\paperwidth,%
			sep=0pt,%
			leftskip=\gotham@frametitle@leftpadding,%
			rightskip=\gotham@frametitle@rightpadding,%
		]{frametitleSection}%
		\gotham@frametitlestrut@start%
		\parbox[c][2.5cm][c]{0.15\paperwidth}{
			\insertframetitle%
			\ifx\insertframesubtitle\@empty%% if subtitle to the frame is not empty
			\else%
				{ -- \usebeamerfont{framesubtitle}\usebeamercolor[fg]{framesubtitle}\insertframesubtitle}%% add subtitle
			\fi%% end if
		}
		\nolinebreak%
		\gotham@frametitlestrut@end%
	\end{beamercolorbox}%
	\vspace*{-2.5cm}%
}

\defbeamertemplate*{section frame}{gotham}[1][]%
{%
	% \usebeamertemplate*{section page}% already included
	\setbeamertemplate{background canvas}[section gotham]%
	\setbeamertemplate{frametitle}[section gotham]%
}%

\defbeamertemplate*{subsection frame}{gotham}[1][]%
{%
	% \usebeamertemplate*{section page}% already included
	\setbeamertemplate{background canvas}[subsection gotham]%
	\setbeamertemplate{frametitle}[section gotham]%
}%

\defbeamertemplate*{subsubsection frame}{gotham}[1][]%
{%
	% \usebeamertemplate*{section page}% already included
	\setbeamertemplate{background canvas}[subsubsection gotham]%
	\setbeamertemplate{frametitle}[section gotham]%
}%

\defbeamertemplate*{toc section frame}{gotham}[1][]%
{%
	% \usebeamertemplate*{section page}% already included
	\setbeamertemplate{background canvas}[toc section gotham]%
	\setbeamertemplate{frametitle}[toc gotham]%
}%

\defbeamertemplate*{toc subsection frame}{gotham}[1][]%
{%
	% \usebeamertemplate*{section page}% already included
	\setbeamertemplate{background canvas}[toc subsection gotham]%
	\setbeamertemplate{frametitle}[toc gotham]%
}%

\providebool{sectionframe}
\define@key{beamerframe}{section}[true]{
	\booltrue{sectionframe}
	\begingroup
		\usebeamertemplate{section frame}
}
\apptocmd{\beamer@reseteecodes}{% reseteecodes=???
	\ifbool{sectionframe}{% true
		\endgroup
		\boolfalse{sectionframe}
	}{}% else (false) do nothing
}{}{}%

\providebool{subsectionframe}
\define@key{beamerframe}{subsec}[true]{
	\booltrue{subsectionframe}
	\begingroup
		\usebeamertemplate{subsection frame}
}
\apptocmd{\beamer@reseteecodes}{% reseteecodes=???
	\ifbool{subsectionframe}{% true
		\endgroup
		\boolfalse{subsectionframe}
	}{}% else (false) do nothing
}{}{}%

\providebool{subsubsectionframe}
\define@key{beamerframe}{subsubsec}[true]{
	\booltrue{subsubsectionframe}
	\begingroup
		\usebeamertemplate{subsubsection frame}
}
\apptocmd{\beamer@reseteecodes}{% reseteecodes=???
	\ifbool{subsubsectionframe}{% true
		\endgroup
		\boolfalse{subsubsectionframe}
	}{}% else (false) do nothing
}{}{}%

%% Table of Content %%%
%%%%%%%%%%%%%%%%%%%%%%%
\defbeamertemplate{background canvas}{toc gotham}[1][]
{%
	\ifbeamercolorempty[bg]{background standin}{}{\color{bg}\vrule width\paperwidth height\paperheight}
	% \begin{tikzpicture}[overlay,remember picture]
	% 	\node[color=red, opacity=0.3, scale=5, rotate=45] at ([shift={(0,0)}]current page.center) {TOC};
	% \end{tikzpicture}%
}

\defbeamertemplate*{section in toc}{gotham}{%
	{{\inserttocsectionnumber}.}~\inserttocsection%
	\\%
}
\defbeamertemplate*{subsection in toc}{gotham}{%
	\quad{{\inserttocsectionnumber}.\inserttocsubsectionnumber.}~\inserttocsubsection%
	\\%
}
\defbeamertemplate*{subsubsection in toc}{gotham}{%
	\qquad{{\inserttocsectionnumber}.\inserttocsubsectionnumber.\inserttocsubsubsectionnumber.}~\inserttocsubsubsection%
	\\%
}

\defbeamertemplate*{toc page}{gotham}[1][]%
{%
	\setbeamertemplate{background canvas}[toc gotham]%
}%

\providebool{tocframe}
\define@key{beamerframe}{toc}[true]{
	\booltrue{tocframe}
	\begingroup
		\usebeamertemplate{toc page}
}
\apptocmd{\beamer@reseteecodes}{% ???
	\ifbool{tocframe}{% true
		\endgroup
		\boolfalse{tocframe}
	}{}% else (false) do nothing
}{}{}%

\providebool{tocsecframe}
\define@key{beamerframe}{tocsec}[true]{
	\booltrue{tocsecframe}
	\begingroup
		\usebeamertemplate{toc section frame}
}
\apptocmd{\beamer@reseteecodes}{% reseteecodes=???
	\ifbool{tocsecframe}{% true
		\endgroup
		\boolfalse{tocsecframe}
	}{}% else (false) do nothing
}{}{}%

\providebool{tocsubsecframe}
\define@key{beamerframe}{tocsubsec}[true]{
	\booltrue{tocsubsecframe}
	\begingroup
		\usebeamertemplate{toc subsection frame}
}
\apptocmd{\beamer@reseteecodes}{% reseteecodes=???
	\ifbool{tocsubsecframe}{% true
		\endgroup
		\boolfalse{tocsubsecframe}
	}{}% else (false) do nothing
}{}{}%

\providebool{tocsubsubsecframe}
\define@key{beamerframe}{tocsubsubsec}[true]{
	\booltrue{tocsubsubsecframe}
	\begingroup
		\usebeamertemplate{toc subsubsection frame}
}
\apptocmd{\beamer@reseteecodes}{% reseteecodes=???
	\ifbool{tocsubsubsecframe}{% true
		\endgroup
		\boolfalse{tocsubsubsecframe}
	}{}% else (false) do nothing
}{}{}%
%%%%%%%%%%%%%%%%%


%% Background %%%
%%%%%%%%%%%%%%%%%



% Background lengths
\newlength{\imageBGoffset}
\setlength{\imageBGoffset}{\paperwidth}
\addtolength{\imageBGoffset}{-8.5mm}




%% Environments styles %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%
\newlength{\gotham@blocksep}
\newlength{\gotham@blockadjust}
\setlength{\gotham@blocksep}{0.75ex}
\setlength{\gotham@blockadjust}{0.25ex}
\providecommand{\gotham@strut}{%
	\vphantom{ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz()}%
}
\newcommand{\gotham@block}[1]{
	\par\vskip\medskipamount%
	\setlength{\parskip}{0pt}
	\ifbeamercolorempty[bg]{block title#1}{%
		\begin{beamercolorbox}[rightskip=0pt plus 4em]{block title#1}}{%
	\ifbeamercolorempty[bg]{block title}{%
		\begin{beamercolorbox}[rightskip=0pt plus 4em]{block title#1}%
	}%
	{%
		\begin{beamercolorbox}[
			sep=\dimexpr\gotham@blocksep-\gotham@blockadjust\relax,
			leftskip=\gotham@blockadjust,
			rightskip=\dimexpr\gotham@blockadjust plus 4em\relax
		]{block title#1}%
	}}%
			\usebeamerfont*{block title#1}%
			\gotham@strut%
			\insertblocktitle%
			\gotham@strut%
	\end{beamercolorbox}%
	\nointerlineskip%
	\ifbeamercolorempty[bg]{block body#1}{%
		\begin{beamercolorbox}[vmode]{block body#1}}{
	\ifbeamercolorempty[bg]{block body}{%
		\begin{beamercolorbox}[vmode]{block body#1}%
	}{%
		\begin{beamercolorbox}[sep=\gotham@blocksep, vmode]{block body#1}%
		\vspace{-\gotham@parskip}
	}}%
			\usebeamerfont{block body#1}%
			\setlength{\parskip}{\gotham@parskip}%
}
\defbeamertemplate*{block begin}{gotham}{\gotham@block{}}
\defbeamertemplate*{block alerted begin}{gotham}{\gotham@block{ alerted}}
\defbeamertemplate*{block example begin}{gotham}{\gotham@block{ example}}
\defbeamertemplate*{block end}{gotham}{\end{beamercolorbox}\vspace*{0.2ex}}
\defbeamertemplate*{block alerted end}{gotham}{\end{beamercolorbox}\vspace*{0.2ex}}
\defbeamertemplate*{block example end}{gotham}{\end{beamercolorbox}\vspace*{0.2ex}}
\defbeamertemplate*{itemize items}{gotham}{\textbullet}
\defbeamertemplate*{caption label separator}{gotham}{: }
\setbeamertemplate{caption}[numbered]
\defbeamertemplate*{footnote}{gotham}{%
	\parindent 0em\noindent%
	\raggedright
	\usebeamercolor{footnote}\hbox to 0.8em{\hfil\insertfootnotemark}\insertfootnotetext\par%
}
\newlength{\gotham@parskip}
\setlength{\gotham@parskip}{0.5em}
\setlength{\parskip}{\gotham@parskip}
\linespread{1.15}

\define@key{beamerframe}{c}[true]{% centered vertically ?
	\beamer@frametopskip=0pt plus 1fill\relax%
	\beamer@framebottomskip=0pt plus 1fill\relax%
	\beamer@frametopskipautobreak=0pt plus .4\paperheight\relax%
	\beamer@framebottomskipautobreak=0pt plus .6\paperheight\relax%
	\def\beamer@initfirstlineunskip{}%
}

\defbeamertemplate{background canvas}{standout gotham}[1][]{%
	\ifbeamercolorempty[bg]{background standout}{}{\color{bg}\vrule width\paperwidth height\paperheight}% copied beamer default here
	% \hspace*{25.15pt}%
   % \begin{beamercolorbox}[wd=\paperwidth, ht=\paperheight]{background standout}
   % \end{beamercolorbox}%
   % \begin{tikzpicture}[overlay,remember picture]
   %    \node[color=gray, opacity=0.3, scale=5, rotate=45] at ([shift={(0,0)}]current page.center) {STANDOUT};
   % \end{tikzpicture}%
}%

\defbeamertemplate*{standout}{gotham}[1][]{%
	%
	% \setkeys{beamerframe}{c}
	% \setkeys{beamerframe}{noframenumbering}
	% \centering
	\setbeamertemplate{background canvas}[standout gotham]
	% \usebeamertemplate{background canvas}%[standout gotham]
	\usebeamerfont{standout}
	%
	\ifbeamercolorempty[bg]{palette primary}{%true : empty background (light)
		\setbeamercolor{background canvas}{
			use=palette primary,
			bg=palette primary.fg %-palette primary.fg
		}
	}{%false : background not empty (dark)
		\setbeamercolor{background canvas}{
			use=palette primary,
			bg=palette primary.bg
		}
	}
	\setbeamercolor{local structure}{
		fg=palette primary.bg
	}
	\usebeamercolor[fg]{palette primary}
}%

\providebool{gotham@standout}
\define@key{beamerframe}{standout}[true]{%
	\booltrue{gotham@standout}
	\begingroup
		\usebeamertemplate{standout}
}
	\apptocmd{\beamer@reseteecodes}{%
		\ifbool{gotham@standout}{
			\endgroup
			\boolfalse{gotham@standout}
		}{}
	}{}{}

\defbeamertemplate{background canvas}{standin gotham}[1][]{%
	\ifbeamercolorempty[bg]{background standin}{}{\color{bg}\vrule width\paperwidth height\paperheight}
   % \begin{tikzpicture}[overlay,remember picture]
   %    \node[color=gray, opacity=0.3, scale=5, rotate=45] at ([shift={(0,0)}]current page.center) {STANDin};
   % \end{tikzpicture}%
}%

\defbeamertemplate*{standin}{gotham}[1][]{%
	%
	% \setkeys{beamerframe}{c}
	% \setkeys{beamerframe}{noframenumbering}
	% \centering
	\setbeamertemplate{background canvas}[standin gotham]
	% \usebeamertemplate{background canvas}%[standin gotham]
	\usebeamerfont{standin}
	%
	% \ifbeamercolorempty[bg]{palette primary}{%true : empty background (light)
	% 	\setbeamercolor{background canvas}{
	% 		use=palette primary,
	% 		bg=palette primary.fg %-palette primary.fg
	% 	}
	% }{%false : background not empty (dark)
	% 	\setbeamercolor{background canvas}{
	% 		use=palette primary,
	% 		bg=palette primary.bg
	% 	}
	% }
	% \setbeamercolor{local structure}{
	% 	fg=palette primary.bg
	% }
	% \usebeamercolor[fg]{palette primary}
	\setbeamercolor{frametitle}{
		use=palette primary,
		bg=palette primary.fg,
		fg=palette primary.bg
	}
}%

\providebool{gotham@standin}
\define@key{beamerframe}{standin}[true]{%
	\booltrue{gotham@standin}
	\begingroup
		\usebeamertemplate{standin}
}
	\apptocmd{\beamer@reseteecodes}{%
		\ifbool{gotham@standin}{
			\endgroup
			\boolfalse{gotham@standin}
		}{}
	}{}{}
\gotham@inner@setdefaults
\ProcessPgfPackageOptions{/gotham/inner}
%\endinput
%%
%% End of file `beamerinnerthemegotham.sty'.

% \useoutertheme{gotham}
%% This is file `beamerouterthemegotham.sty',
%==============================================================================
% \NeedsTeXFormat{LaTeX2e}
% \ProvidesPackage{beamerouterthemegotham}[2017/01/23 gotham outer theme]
\RequirePackage{etoolbox}
\RequirePackage{calc}
\RequirePackage{pgfopts}
\pgfkeys{
	/gotham/outer/numbering/.cd,
		.is choice,
		none/.code=\setbeamertemplate{frame numbering}[none],
		counter/.code=\setbeamertemplate{frame numbering}[counter],
		fraction/.code=\setbeamertemplate{frame numbering}[fraction],
}
\pgfkeys{
	/gotham/outer/progressbar/.cd,
		.is choice,
		none/.code={%
			\setbeamertemplate{headline}[plain]
			\setbeamertemplate{frametitle}[plain]
			\setbeamertemplate{footline}[plain]
		},
		head/.code={\pgfkeys{/gotham/outer/progressbar=none}
			\addtobeamertemplate{headline}{}{%
				\usebeamertemplate*{progress bar in head/foot}
			}
		},
		frametitle/.code={\pgfkeys{/gotham/outer/progressbar=none}
			\addtobeamertemplate{frametitle}{}{%
				\usebeamertemplate*{progress bar in head/foot}
			}
		},
		foot/.code={\pgfkeys{/gotham/outer/progressbar=none}
			\addtobeamertemplate{footline}{}{%
				\usebeamertemplate*{progress bar in head/foot}%
			}
		},
}
\newcommand{\gotham@outer@setdefaults}{
	\pgfkeys{/gotham/outer/.cd,
		numbering=counter,
		progressbar=none,
	}
}

\defbeamertemplate{navigation symbols}{bottomline}{
	\usebeamercolor[fg]{navigation symbols}%
	\insertslidenavigationsymbol%
	\insertframenavigationsymbol%
	\insertsubsectionnavigationsymbol%
	\insertsectionnavigationsymbol%
	\insertdocnavigationsymbol%
	\insertbackfindforwardnavigationsymbol%
}
\defbeamertemplate*{navigation symbols}{empty}{}

\newcommand{\gothamInstituteLogo}{%
	gotham institute logo
}

% bool to trigger the add of rotation of the footer
\providebool{rotateFooter}
\booltrue{rotateFooter}

% bool to display the rotated footer by default (or not)
\providebool{defaultRotateFooter}
\boolfalse{defaultRotateFooter}

% At every new frame, reset the options to default (unless some options/keys are given)
\BeforeBeginEnvironment{frame}{%
	\ifbool{defaultRotateFooter}{% true
		\booltrue{rotateFooter}% by default the rotateFooter is enable.
	}{% false
		\boolfalse{rotateFooter}% by default the rotateFooter is disable.	
	}%
}

% Capture new options/keys for frames 
%\makeatletter
	\define@key{beamerframe}{rotateFooter}[true]{% if key 'rotateFooter' captured:
		\booltrue{rotateFooter}% then, turn on rotateFooter bool 
	}
	\define@key{beamerframe}{norotatefooter}[true]{% if key 'norotatefooter' captured:
		\boolfalse{rotateFooter}% then, turn off rotateFooter bool
	}
%\makeatother


% Footline lengths
\newlength{\footlineOffset}% space between to bottom of the text (or the footnote) and the footline
\setlength{\footlineOffset}{-2.0ex} 

\newlength{\leftFooterPadding} % space between the left page border and left side of the footer
\setlength{\leftFooterPadding}{2.0ex} 
\newlength{\rightFooterPadding} % space between the right page border and right side of the footer
\setlength{\rightFooterPadding}{3.5ex} 

\defbeamertemplate{logo}{empty}[1][]{}
% % bool to trigger the add of watermark in background
\providebool{gotham@nologo}
\boolfalse{gotham@nologo}
% Capture new options/keys for frames 
\define@key{beamerframe}{nologo}[true]{%
	\booltrue{gotham@nologo}
	\begingroup
		\setbeamertemplate{logo}[empty]
}
\apptocmd{\beamer@reseteecodes}{%
	\ifbool{gotham@nologo}{
		\endgroup
		\boolfalse{gotham@nologo}
	}{}
}{}{}

\defbeamertemplate{frame footer}{none}[1][]{}
% % bool to trigger the add of watermark in background
\providebool{gotham@nofooter}
\boolfalse{gotham@nofooter}
% Capture new options/keys for frames 
\define@key{beamerframe}{nofooter}[true]{%
	\booltrue{gotham@nofooter}
	\begingroup
		\setbeamertemplate{frame footer}[empty]
}
\apptocmd{\beamer@reseteecodes}{%
	\ifbool{gotham@nofooter}{
		\endgroup
		\boolfalse{gotham@nofooter}
	}{}
}{}{}

% bool to trigger the add of watermark in background
\providebool{gotham@nofootline}
\boolfalse{gotham@nofootline}
% Capture new options/keys for frames 
\define@key{beamerframe}{nofootline}[true]{%
	\booltrue{gotham@nofootline}
	\begingroup
		\setbeamertemplate{footline}[empty]
}
\apptocmd{\beamer@reseteecodes}{%
	\ifbool{gotham@nofootline}{
		\endgroup
		\boolfalse{gotham@nofootline}
	}{}
}{}{}

\defbeamertemplate{frame footer}{custom}[1]{ #1 }
\defbeamertemplate{frame numbering}{counter}{\insertframenumber}
\defbeamertemplate{frame numbering}{fraction}{
	\insertframenumber/\inserttotalframenumber
}
\defbeamertemplate{headline}{plain}{}
\defbeamertemplate{footline}{empty}[1][]{}
\defbeamertemplate{footline}{plain}{%
	\vspace*{\footlineOffset} % new line to adjust the footline position.
	\begin{beamercolorbox}[wd=\textwidth, sep=3ex]{footline}%
		\usebeamerfont{page number in head/foot}%
		% \ifbeamertemplateempty{⟨beamer template name⟩}{⟨executed if empty⟩}{⟨executed otherwise⟩
		\ifbeamertemplateempty{frame footer}{%executed if empty
			\hfill
		}{%⟨executed otherwise⟩
			\usebeamertemplate*{frame footer}
		}
		\hspace{\rightFooterPadding}%
		\usebeamertemplate*{frame numbering}\
	\end{beamercolorbox}%
}

\newlength{\gotham@frametitle@toppadding}
\setlength{\gotham@frametitle@toppadding}{2.2ex}
\newlength{\gotham@frametitle@bottompadding}
\setlength{\gotham@frametitle@bottompadding}{2.2ex}
\newlength{\gotham@frametitle@leftpadding}
\setlength{\gotham@frametitle@leftpadding}{2.2ex}
\newlength{\gotham@frametitle@rightpadding}
\setlength{\gotham@frametitle@rightpadding}{2.2ex}
\newcommand{\gotham@frametitlestrut@start}{
	\rule{0pt}{\gotham@frametitle@toppadding +%
		\totalheightof{%
			\ifcsdef{gotham@frametitleformat}{\gotham@frametitleformat X}{X}%
		}%
	}%
}
\newcommand{\gotham@frametitlestrut@end}{
	\rule[-\gotham@frametitle@bottompadding]{0pt}{\gotham@frametitle@bottompadding}
}
\defbeamertemplate{frametitle}{plain}{%
	\nointerlineskip%
	\begin{beamercolorbox}[%
			wd=\paperwidth,%
			sep=0pt,%
			leftskip=\gotham@frametitle@leftpadding,%
			rightskip=\gotham@frametitle@rightpadding,%
		]{frametitle}%
		\gotham@frametitlestrut@start%
		\insertframetitle%
		\ifx\insertframesubtitle\@empty%% if subtitle to the frame is not empty
		\else%
			{ -- \usebeamerfont{framesubtitle}\usebeamercolor[fg]{framesubtitle}\insertframesubtitle}%% add subtitle
		\fi%% end if
		\nolinebreak%
		\gotham@frametitlestrut@end%
	\end{beamercolorbox}%
}
\defbeamertemplate*{frametitle continuation}{gotham}{%
	\usebeamerfont{frametitle}
	\romannumeral \insertcontinuationcount
}
\newlength{\gotham@progressinheadfoot}
\newlength{\gotham@progressinheadfoot@linewidth}
\setlength{\gotham@progressinheadfoot@linewidth}{1.2ex}%{1.0ex}%{0.4pt}
\defbeamertemplate*{progress bar in head/foot}{gotham}{
	\nointerlineskip
	\setlength{\gotham@progressinheadfoot}{%
		\paperwidth * \ratio{\insertframenumber pt}{\inserttotalframenumber pt}%
	}%
	\begin{beamercolorbox}[wd=\paperwidth]{progress bar in head/foot}
		\begin{tikzpicture}
			\fill[bg] (0,0) rectangle (\paperwidth, \gotham@progressinheadfoot@linewidth);
			\fill[fg] (0,0) rectangle (\gotham@progressinheadfoot, \gotham@progressinheadfoot@linewidth);
		\end{tikzpicture}%
	\end{beamercolorbox}
}
\newlength{\footerOffset}% space between the footer and the bottom of the page (or the progressbar)
\setlength{\footerOffset}{-1.5\gotham@progressinheadfoot@linewidth}

\newlength{\hposLeftRotFooter}
\newlength{\hposRightRotFooter}
\newlength{\vposLeftRotFooter}
\newlength{\vposRightRotFooter}% horizontal position (in picture env) for the rotated footer.

\setlength{\hposLeftRotFooter}{-9pt}%
\setlength{\hposRightRotFooter}{6pt}%
\setlength{\vposLeftRotFooter}{0pt}%
\setlength{\vposRightRotFooter}{15pt}%

\newlength{\hlenRightRotFooter}
\newlength{\hlenLeftRotFooter}


% frame footer
\defbeamertemplate{frame footer}{empty}[1][]{%
	\hspace{\leftFooterPadding}%
	\hfill \
	\vspace*{\footerOffset}% decrease space between progress bar and footer
}

\defbeamertemplate*{frame footer}{gotham}[1][]{%
	\hspace{\leftFooterPadding}%
	\settowidth{\hlenLeftRotFooter}{\hspace{-\leftFooterPadding}}
	\addtolength{\hlenLeftRotFooter}{\hposLeftRotFooter}
	\ifbool{rotateFooter}{% rotateFooter true
		\begin{picture}(0,0)(0,0)
			\put(\hlenLeftRotFooter,\vposLeftRotFooter){\rotatebox{90}{\insertshortdate}}
		\end{picture}
	}{% rotateFooter false
		\insertshortdate
	}
	\hfill \
	\hfill \ \insertshorttitle
	\hfill \ %
	\hfill \
	\ifbool{rotateFooter}{% rotateFooter true
		\settowidth{\hlenRightRotFooter}{\hspace{\rightFooterPadding}\usebeamertemplate*{frame numbering}}
		\addtolength{\hlenRightRotFooter}{\hposRightRotFooter}
		\begin{picture}(0,0)(0,0)
			\put(\hlenRightRotFooter,\vposRightRotFooter){\rotatebox{90}{\insertshortauthor}}
		\end{picture}
	}{% rotateFooter false
		\insertshortauthor %\hspace{-7em}
	}
	\vspace*{\footerOffset}% decrease space between progress bar and footer
}%


%% Sidebars %%%
%%%%%%%%%%%%%%%

% sidebar lengths
\newlength{\sidebarRightOffset}
\setlength{\sidebarRightOffset}{-8.4mm}
% \addtolength{\sidebarRightoffset}{}

% Command to add filigrane/edging in sidebar
\newcommand{\gothamFiligrane}{%
	\rotatebox{90}{gotham filigrane pattern}
}

\defbeamertemplate{sidebar canvas right}{empty}{}
\defbeamertemplate{sidebar canvas right}{gotham filigrane}{%
	\hspace*{\sidebarRightOffset}% pull to the left otherwise, the filigrane is outside of the frame.
	\gothamFiligrane%
}

% bool to trigger the add of edging in background
\providebool{gotham@edging}
\boolfalse{gotham@edging}
% bool to trigger the add of edging in background
\providebool{gotham@noedging}
\boolfalse{gotham@noedging}
% bool to display the edging by default (or not)
\providebool{defaultEdging}
\booltrue{defaultEdging}

% At every new frame, reset the options to default (unless some options/keys are given)
\BeforeBeginEnvironment{frame}{%
	\ifbool{defaultEdging}{% true
		\setbeamertemplate{sidebar canvas right}[gotham filigrane]
	}{% false
		\setbeamertemplate{sidebar canvas right}[empty]
	}%
}
% Capture new options/keys for frames 
\define@key{beamerframe}{edging}[true]{%
	\booltrue{gotham@edging}
	\begingroup
		\setbeamertemplate{sidebar canvas right}[gotham filigrane]
}
	\apptocmd{\beamer@reseteecodes}{%
		\ifbool{gotham@edging}{
			\endgroup
			\boolfalse{gotham@edging}
		}{}
	}{}{}
\define@key{beamerframe}{noedging}[true]{%
	\booltrue{gotham@noedging}
	\begingroup
		\setbeamertemplate{sidebar canvas right}[empty]
}
	\apptocmd{\beamer@reseteecodes}{%
		\ifbool{gotham@noedging}{
			\endgroup
			\boolfalse{gotham@noedging}
		}{}
	}{}{}


\AtBeginDocument{%
	\apptocmd{\appendix}{%
		\pgfkeys{%
			/gotham/outer/.cd,
			numbering=none,
			progressbar=none}
		}{}{}
}
\gotham@outer@setdefaults
\ProcessPgfPackageOptions{/gotham/outer}
%\endinput
%%
%% End of file `beamerouterthemegotham.sty'.

% CONTINUE %% This is file `beamerthemegotham.sty',
%==============================================================================
\AtEndPreamble{%
	\@ifpackageloaded{pgfplots}{%
		\RequirePackage{pgfplotsthemetol}
	}{}
}
\newcommand{\gothamset}[1]{\pgfkeys{/gotham/.cd,#1}}
\def\gotham@plaintitleformat#1{#1}
\newcommand{\mreducelistspacing}{\vspace{-\topsep}}
\gotham@setdefaults
\ProcessPgfOptions{/gotham}
\endinput
%%
%% End of file `beamerthemegotham.sty'.


% \ifbeamertemplateempty{⟨beamer template name⟩}{⟨executed if empty⟩}{⟨executed otherwise⟩

% \begin{beamercolorbox}[ignorebg]{⟨beamer color⟩}
% 	⟨environment contents⟩
% 	\end{beamercolorbox}